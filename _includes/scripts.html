<script src="{{ base_path }}/assets/js/main.min.js"></script>

{% include analytics.html %}
{% include /comments-providers/scripts.html %}

{% if site.author.wechat_qr %}
<script>
function showWeChatQR() {
  if (document.getElementById('wechat-qr-modal')) {
    document.getElementById('wechat-qr-modal').style.display = 'flex';
    return;
  }
  
  var modal = document.createElement('div');
  modal.id = 'wechat-qr-modal';
  modal.style.cssText = 'display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 10000; justify-content: center; align-items: center;';
  
  var qrContainer = document.createElement('div');
  qrContainer.style.cssText = 'background: white; padding: 20px; border-radius: 10px; text-align: center; position: relative;';
  
  var closeBtn = document.createElement('button');
  closeBtn.innerHTML = '×';
  closeBtn.style.cssText = 'position: absolute; top: 5px; right: 15px; background: none; border: none; font-size: 30px; cursor: pointer; color: #999;';
  closeBtn.onclick = function() { modal.style.display = 'none'; };
  
  var img = document.createElement('img');
  img.src = '{{ base_path }}/images/{{ site.author.wechat_qr }}';
  img.style.cssText = 'width: 300px; height: 300px;';
  
  var text = document.createElement('p');
  text.innerHTML = '扫描二维码添加微信';
  text.style.cssText = 'margin: 10px 0 0 0; color: #333;';
  
  qrContainer.appendChild(closeBtn);
  qrContainer.appendChild(img);
  qrContainer.appendChild(text);
  modal.appendChild(qrContainer);
  document.body.appendChild(modal);
  
  modal.onclick = function(e) {
    if (e.target === modal) {
      modal.style.display = 'none';
    }
  };
}

document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    var modal = document.getElementById('wechat-qr-modal');
    if (modal) {
      modal.style.display = 'none';
    }
  }
});
</script>
{% endif %}
